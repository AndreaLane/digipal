{% extends "base.html" %}
{% load pages_tags mezzanine_tags i18n %}
{% load mezzanine_tags pagination_tags %}
{% block main %}

 <h2 class='header1'>Search</h2>
        <form id='searchform' class="form-inline" method="GET" action=".">
            {# {% csrf_token %} #}
        <div class='container'>
          <div class='span7'>
                {{ searchform.as_ul }}            
          </div>
            <div class='span3'>
              <input type="submit" value="Search" class='btn btn-primary' />
              <input type='reset' class='btn' />
            </div>
        </div>
            <div class='container'>
                 <script>
                    $(document).ready(function() {
                        var radio = $("#searchform input[type='radio']");

                        // Setting default radio
                        var container = $('#containerFilters');
                        var content = $('{{ filterHands.as_ul|escapejs }}');
                        container.html(content);

                        // Setting default label
                        var labelFilters = $('#labelFilters');
                        var label = "<h5 class='header1'><b>Show Hands filtered by:</b></h5>";
                        labelFilters.html(label);

                        // event onchange on radios
                        radio.change(function(){
                            content = '';
                            label = '';                       
                            if($("#searchform input[type='radio']:checked").val() == 'hands'){
                                content += '{{ filterHands.as_ul|escapejs }}';
                                label += "<h5 class='header1'><b>Show Hands filtered by:</b></h5>";
                            } else if($("#searchform input[type='radio']:checked").val() == 'manuscripts') {
                                content += '{{filterManuscripts.as_ul|escapejs}}';
                                label += "<h5 class='header1'><b>Show Manuscripts filtered by:</b></h5>";
                            } else {
                                content += '{{filterScribes.as_ul|escapejs}}';
                                label += "<h5 class='header1'><b>Show Scribes filtered by:</b></h5>";
                            }
                            labelFilters.html(label);
                            container.html(content);
                       });
                    });
                </script>
                    <div id='labelFilters'></div>
                    <div id='containerFilters'></div>
            </div>              
            <h5 class='header1'><b>Show Graphs filtered by:</b></h5>
              {{ drilldownform.as_ul }}
            <div>
              <p><input type="submit" value="Show Graphs" class='btn btn-primary' /> <input type='reset' class='btn' /></p>
            </div>
        </form>
      <h2 class='header1'>Results for <i>Hands</i></h2>
    <table class="table table-condensed">
        <tr>
            <th>Scribe</th>
            <th>Place</th>
            <th>Date</th>
            <th>Repository</th>
            <th>Shelfmark</th>
            <th>Catalogue Number</th>
            <th>Actions</th>
        </tr> 
        {% autopaginate results 9 %}
        {% for result in results %}
        <tr class="{% cycle 'bgColour' '' %}">
          <td>{{ result.scribe.name }}</td>
          <td>{{ result.assigned_place.name }}</td>
          <td>{{ result.assigned_date.date }}</td>
          <td>{{ result.item_part.current_item.repository.name }}</td>
          <td>{{ result.item_part.current_item.shelfmark }}</td>
          <td>{{ result.item_part.historical_item.catalogue_number }}</td>
          <td>
              <ul class="nav nav-tabs">
                  {% if request.session.admin %}
                  <li><a class="ctrl add" href="../admin/hand/hand/{{ result.id }}">Edit</a></li>
                  {% endif %}
                  <li><a class="ctrl view" href="?terms={{ terms }}&amp;basic_search_type={{ type }}&amp;id={{ result.id }}&amp;record={{ forloop.counter }}">View</a></li>
                  <li><a class="ctrl view" href="../image-display/?style=grid&amp;basic_search_type={{ type }}&amp;id={{ result.id }}&amp;record={{ forloop.counter }}">Grid</a></li>
                  <li class='active'><a class="ctrl view" href="../image-display/?style=list&amp;basic_search_type={{ type }}&amp;id={{ result.id }}&amp;record={{ forloop.counter }}">List</a></li>
              </ul>
          </td>
      </tr>
      {% endfor %}
      {% paginate %}
    </table>
    
{% endblock main %}
