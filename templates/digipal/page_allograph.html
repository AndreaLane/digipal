{% extends "base.html" %}

{% if data %}
{% block meta-title %}Page Allograph{% endblock %}

{% block extra_head %}
<script type="text/javascript">
  function selectFeature(id) {
    window.opener.annotator.selectFeatureByIdAndCentre(id);
    window.opener.focus();
    return false;
  }
</script>
{% endblock %}

{% block main %}
<div class="annotations">
  {% for key, allographs in data.items %}
  <div class="scribe">
    <h1 class='header1'>{{ key }}</h1>
    {% for key, annotations in allographs.items %}
    <div>
      <h3>{{ key }}</h3>
      <ul>
        {% for annotation in annotations %}
        <li>
        <p>
        <a href="{{ annotation.cutout }}">View</a>
        {% if request.session.admin %}
        <span> | </span>
        <a href="{% url admin:digipal_graph_change annotation.graph.id %}">Edit</a></p>
        {% else %}
        </p>
        {% endif %}
        <a href="#" onclick="selectFeature('{{ annotation.vector_id}}');">
        {{ annotation.thumbnail }}
        </a> 
        </li>
        {% endfor %}
      </ul>
    </div>
    {% endfor %}
  </div>
  {% endfor %}
</div>
{% endblock %}
{% else %}
<p>No annotations available.</p>
{% endif %}
