{% extends "base.html" %}

{% if data %}
{% block meta-title %}Page Allograph{% endblock %}

{% block extra_head %}
<script type="text/javascript">
  function selectFeature(id) {
    window.opener.annotator.selectFeatureByIdAndCentre(id);
    window.opener.focus();
    return false;
  }
</script>
{% endblock %}

{% block main %}
<div class="row-fluid" id='annotations'>
  {% for key, allographs in data.items %}
  <div class="span12">
    <h1>{{ key }}</h1>
    {% for key, annotations in allographs.items %}
    <h3>{{ key }}</h3>
      {% for annotation in annotations %}
      <div class='divAnnotations'>
        <span><a href="{{ annotation.cutout }}">View</a></span>
        {% if request.session.admin %}
        <span> | </span>
        <a href="{% url admin:digipal_graph_change annotation.graph.id %}">Edit</a>
        {% endif %}
        <span><a href="#" onclick="selectFeature('{{ annotation.vector_id}}');">
        {{ annotation.thumbnail }}
      </span>
      </a> 
    </div>
      {% endfor %}
    </p>
    {% endfor %}
  </div>
  {% endfor %}
</div>
{% endblock %}
{% else %}
<p>No annotations available.</p>
{% endif %}
