TODO

http://localhost/digipal/manuscripts/553/texts/view/#text-viewer
http://localhost/digipal/manuscripts/199/texts/view/

XML-HTML -> XML

    <span data-dpt="tag" data-dpt-attr1="val1">content</span>
    
    ->
    
    <tag attr1="val1">content</tag>

XML

    H<expan>enry</expan>
        () H<expan abbrev="">enry</expan>
        Different from TEI
    

BOTH

    More efficient saving:

    fix undo/redo!
    
    conversion of the format to html
        ()
        italics
        |
        <>
        and back
        Tironian mark

    mark-up
        [DONE] expansion
            [DONE]add button & mark up selection
            [DONE] icon
        supplied
        deletion
        [DONE] clauses
            drop-down
        [DONE] clear
        
        [DONE] show the mark up
            basic styling

        keep surrounding spaces out of some of the the markup (e.g. expansion)

        line breaks
    
    saving
        saving bug
            don't count loading as a modification of the text
            detect all changes in the content
        regular saving
            avoid simultaneous savings
            avoid too frequent savings
        () backup button
            add a new table: TextContentXMLBackup
            add a button to save to this table
            auto-save before large operations
            
    Document the editor in Confluence

    () . read only mode 

    () Image Panel
        zoom inset on click 
            OR zoomify
        !!Bypass image size quota:
            Zoomify?
            Open Layer?
        
    () Addressability
        Expose and resolve URL leading directly to translation or transcription
    
MOFA

    ** Fix auto save bug: completing a line does not trigger a new save event
    
EXON
    
    Split long texts into small parts
        splitting
        display one piece
        pull locations from database
        location change
    
    ** Structure
        mark up pagination
        extract entry numbers and starting points
        enable navigation using location dropdown
        fragment the text
        * mark-up divisions
            page
            division
            entry
    
    Attach information to an entry
        people
        places
        etc.

    create dummy text, three pages long

    ? mark-up records
        person
        place
        Q: should we use an intermediary record to represent any type of entity? There are some commonalities among rec types such as normalised name, name before and after conquest, etc. 
        Or do we link directly to a Person/Place record?
        Q: what about the distinction between identified entity and occurrence of an entity name?

PUBLIC VIEW

    ***** DON'T SHOW THE FULL SIZE VERSION OF THE IMAGE!
    Switch edit/view

BUGS
    
    Make sure we can't save the content before it is loaded
    What if you edit the same text in different panels?
    Fix the slug in the admin:
        the slug should be read only
        for the moment we always update the slug automatically on save
    TinyMCE will not work well (setContent and editing mode fails) when the panel is collapse at the time of the loading

    
Presentation
    resizing a panel doesn't work smoothly when the mouse goes over TinyMCE
    Fix the panelset being a few pixels too tall
    Layout switches
    Put the digipal style sheets back
        put them back
        fix the banner/nav
    [DONE] relative size of the panels. e.g. 50% split centre and south
    Improve the layout so if the set ratios are preserved even when resizing the browser window
    (Re)design:
        decide if the layout is completely managed by the viewer
        would be nice if west is on the left of south: that would require to nest one layout inside another
    BUG: when you close the south pane the iframe managed by the nested tinymce will loose the content of its head and body.

Improvements
    Panel asks for location list and types. Populate and show controls accordingly (e.g. Text may not want to display it at this stage, Image only shows locations not types).
    Status messages should come from the server?
    
Performance
    The full Exon translation (experiment with FireFox):
        can be added with tinymce, pasted from Word it will strip almost all styles and keep minimal HTML
        pasting takes a long time (~20s) but it is decent given the size of the text however it freezes the browser and we can get javascript performance warnings
        the size is 310KB
        loading the text takes just 150ms but setting it into TinyMCE make the browser freeze for a few seconds 
        sending the text and saving it to the DB takes less than 1 seconds however the browser tends to freeze and be very laggy after a few operations

Maybe
    Image Panel
        layout selection (width fit, height fit, best fit)
    ? show address selector
    Let panels from different browser tabs communicate
        synchronise position
        edition + refresh views, etc.
    Name tables in the admin: in the future we may want to 
        make the slug input writable
        keep the slug as it is even when the name changes 
        but if the slug is blanked (or add an icon for that) we reset it.
    Generalise API:
        query for the list of locations and this can be handled by the custom function on server side
    Show status bar at the bottom of each panel:
        duration of the request
        icon to show the message in full

DONE

    [DONE] Show status bar at the bottom of each panel:
        [DONE] html
        [DONE] CSS
        [DONE] dynamic resize
        [DONE] function to show message
        [DONE] show message
        [DONE] time of the message
        [DONE] truncate the message to make it fit in the available space
    [DONE] WriteTextView
    [DONE] show tinymce
    [DONE] Junicode
    [DONE] Basic TextWrite:
        read text from database (create if not there)
        display it
    [DONE] show only one panel with transcription
    [DONE] auto-save
    
    [DONE] 1. ** Dynamically create the views based on the content types
        [DONE] generic constructor of a panel
        [DONE] update content type drop down
        [DONE] react to changes in the drop down
        [DONE] load the transcription or translation
    [DONE] Basic Image panel
        [DONE] load image
        [DONE] fit to width
        [DONE] scroll only the content
        [DONE] load locations
        [DONE] change location
        
