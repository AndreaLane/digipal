{% extends "base.html" %}
{% load html_escape %}

{% block meta_title %}{{ item_part.display_label }}: Texts{% endblock %}

{% block extra_css %}
    {{ block.super }}
    <link rel="stylesheet" href="{{ STATIC_URL }}digipal_text/junicode/junicode.css"/>
    {% comment %} 
        Trick: TinyMCE will load this later dynamically 
        but that happens AFTER our resize calculate the height of the button bar
        which is unstyled yet and therefore too tall and shrinks the iframe.
        The solution is to force a load of the stylesheet here so the computation 
        is accurate.
    {% endcomment %}
    <link rel="stylesheet" href="{{ STATIC_URL }}digipal_text/tinymce/skins/digipal/skin.min.css"/>
    <link rel="stylesheet" href="{{ STATIC_URL }}digipal_text/viewer/viewer.css"/>
{% endblock %}

{% block main %}

<h1><a href="{{ item_part.get_absolute_url }}">{{ item_part.display_label }}</a>: Texts</h1>

<div id="text-viewer">
    <div class="message-box">
        <a href="#text-viewer" style="float:left;" title="Expand" data-toggle="tooltip" data-placement="bottom"><span class="glyphicon glyphicon-fullscreen" aria-hidden="true"></span></a>
	    <span class="message-content">&nbsp;</span>
    </div>
    <div class="panels">
        {# <div class="ui-layout-north">North</div> #}
        {# <div class="ui-layout-west">Navigator</div> #}
        <div class="ui-layout-center">Text</div>
        <div class="ui-layout-east">East</div>
        {# <div class="ui-layout-south">Images</div> #}
    </div>
</div>

<div id="text-viewer-panel" class="text-viewer-panel">
    <nav class="navbar navbar-default">
        <ul class="nav navbar-nav pull-left">
            <li class="dropdown dropdown-content-type">
                {% include "bootstrap/dropdown.html" with options=dd_content_types %}
            </li>
        </ul>

        <ul class="nav navbar-nav pull-left">
            <li class="dropdown dropdown-location-type pull-left dphidden">
                {% include "bootstrap/dropdown.html" with options=dd_location_types %}
            </li>
            <li class="dropdown-location pull-left dphidden">
                <select name="location" class="">
                    <option value="1r">1r</option>
                    <option value="1v">1v</option>
                </select>
            </li>
	    </ul>
	       
    </nav>
    
    <div class="panel-content">
    </div>
    
    <div class="status-bar">
        <span class="status"></span>
        <span class="message"></span>
        <span class="time pull-right"></span>
    </div>
    
</div>

{% endblock %}

{% block extra_js %}
    {{ block.super }}
    <script src="{{ STATIC_URL }}digipal_text/jqlayout/jquery.layout.min.js"></script>
    {# TODO: include min on production #}
    <script src="{{ STATIC_URL }}digipal_text/tinymce/tinymce.min.js"></script>
    <script type="text/javascript" src="{{ STATIC_URL }}digipal/scripts/dpbootstrap.js"></script>
    <script src="{{ STATIC_URL }}digipal_text/viewer/panelset.tinymce.js"></script>
    <script src="{{ STATIC_URL }}digipal_text/viewer/panelset.js"></script>
    <script type="text/javascript" src="{{ STATIC_URL }}js/chosen.jquery.js"></script>
    <script>
        jQuery(document).ready(function($) {
            var panelset = new TextViewer.PanelSet($('#text-viewer'));
            panelset.setItemPartid('{{ item_partid }}');
            panelset.setLayout($('#text-viewer .panels'));
            panelset.setMessageBox($('#text-viewer .message-box'));
            panelset.setExpandButton($('#text-viewer .message-box a'));
            //panelset.registerPanel(TextViewer.Panel.create('image', '.ui-layout-north'));
            panelset.registerPanel(TextViewer.Panel.create('translation', '.ui-layout-center', true));
            //panelset.registerPanel(TextViewer.Panel.create('translation', '.ui-layout-center', true));
            panelset.registerPanel(TextViewer.Panel.create('transcription', '.ui-layout-east', true));
            //panelset.registerPanel(TextViewer.Panel.create('xmlelement', '.ui-layout-west', true));
            //panelset.registerPanel(TextViewer.Panel.create('image', '.ui-layout-south'));
            //panelset.setPanelSize('west', 0.5);
            panelset.ready();
            //panelset.setPanelSize('south', 0);
            //panelset.setPanelSize('north', 0.4);
            panelset.setPanelSize('east', 0.5);
            //panelset.setPanelSize('center', 0);
            //panelset.setPanelSize('west', 0);
            //panelset.setPanelSize('south', 0);
        });
    </script>
{% endblock %}
